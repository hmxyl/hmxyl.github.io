<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Redis-数据类型（基础）, Alisa&#39;s Home">
    <meta name="description" content="学习笔记、工作心得">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Redis-数据类型（基础） | Alisa&#39;s Home</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Alisa's Home" type="application/atom+xml">
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Alisa&#39;s Home</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Alisa&#39;s Home</div>
        <div class="logo-desc">
            
            学习笔记、工作心得
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/11.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Redis-数据类型（基础）</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Redis/">
                                <span class="chip bg-color">Redis</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" class="post-category">
                                数据库
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-01-03
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1>String</h1>
<table>
<thead>
<tr>
<th style="text-align:left">命令</th>
<th style="text-align:left">使用</th>
<th style="text-align:left">功能</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">SET</td>
<td style="text-align:left">SET <em>key</em> value <br>SET <em>key</em> value ex seconds</td>
<td style="text-align:left">增</td>
<td>储值<br>储值且key在指定秒后过期</td>
</tr>
<tr>
<td style="text-align:left">MSET</td>
<td style="text-align:left">MSET <em>key</em> value [key value …]</td>
<td style="text-align:left">增</td>
<td>同时储多个值</td>
</tr>
<tr>
<td style="text-align:left">SETEX</td>
<td style="text-align:left">SETEX <em>key</em> seconds value</td>
<td style="text-align:left">增</td>
<td>储值，且key在指定秒后过期</td>
</tr>
<tr>
<td style="text-align:left">PSETEX</td>
<td style="text-align:left">PSETEX <em>key</em> milliseconds value</td>
<td style="text-align:left">增</td>
<td>储值，且key在指定毫秒后过期</td>
</tr>
<tr>
<td style="text-align:left">SETNX</td>
<td style="text-align:left">SETNX <em>key</em> value</td>
<td style="text-align:left">增</td>
<td>仅在key不存在时执行</td>
</tr>
<tr>
<td style="text-align:left">MSETNX</td>
<td style="text-align:left">MSETNX <em>key</em> value [key value …]</td>
<td style="text-align:left">增</td>
<td>在所有的key不存在时执行</td>
</tr>
<tr>
<td style="text-align:left">SETRANGE</td>
<td style="text-align:left">SETRANGE <em>key</em> offset value</td>
<td style="text-align:left">改</td>
<td>字符串从offset开始由value替代</td>
</tr>
<tr>
<td style="text-align:left">INCR</td>
<td style="text-align:left">INCR key</td>
<td style="text-align:left">改</td>
<td>key自增</td>
</tr>
<tr>
<td style="text-align:left">DECR</td>
<td style="text-align:left">DECR key</td>
<td style="text-align:left">改</td>
<td>key自减</td>
</tr>
<tr>
<td style="text-align:left">INCRBY</td>
<td style="text-align:left">INCRBY <em>key</em> increment</td>
<td style="text-align:left">改</td>
<td>key增加指定整形量</td>
</tr>
<tr>
<td style="text-align:left">DECRBY</td>
<td style="text-align:left">DECRBY <em>key</em> decrement</td>
<td style="text-align:left">改</td>
<td>key减少指定整形量</td>
</tr>
<tr>
<td style="text-align:left">INCRBYFLOAT</td>
<td style="text-align:left">INCRBYFLOAT <em>key</em> increment</td>
<td style="text-align:left">改</td>
<td>key增加指定浮点量，浮点数为负数则为减少</td>
</tr>
<tr>
<td style="text-align:left">APPEND</td>
<td style="text-align:left">APPEND <em>key</em> value</td>
<td style="text-align:left">改</td>
<td>追加储值</td>
</tr>
<tr>
<td style="text-align:left">GET</td>
<td style="text-align:left">GET <em>key</em></td>
<td style="text-align:left">查</td>
<td>获取key的value</td>
</tr>
<tr>
<td style="text-align:left">MGET</td>
<td style="text-align:left">MGET key [key …]</td>
<td style="text-align:left">查</td>
<td>同时获取多个key</td>
</tr>
<tr>
<td style="text-align:left">GETDEL</td>
<td style="text-align:left">GETDEL <em>key</em></td>
<td style="text-align:left">查&amp;删</td>
<td>获取key的value后删除key</td>
</tr>
<tr>
<td style="text-align:left">GETSET</td>
<td style="text-align:left">GETSET <em>key</em> value</td>
<td style="text-align:left">查&amp;改</td>
<td>set新的value，并返回旧的value</td>
</tr>
<tr>
<td style="text-align:left">GETRANGE</td>
<td style="text-align:left">GETRANGE <em>key</em> start end</td>
<td style="text-align:left">查</td>
<td>获取value的子字符串 （从start到end）</td>
</tr>
<tr>
<td style="text-align:left">SUBSTR</td>
<td style="text-align:left">SUBSTR <em>key</em> start end</td>
<td style="text-align:left">查</td>
<td>获取value的子字符串 （从start到end）</td>
</tr>
<tr>
<td style="text-align:left">STRLEN</td>
<td style="text-align:left">STRLEN key</td>
<td style="text-align:left">查</td>
<td>获取字符串长度</td>
</tr>
</tbody>
</table>
<blockquote>
<p>其他（6.0.6以下版本不支持）</p>
</blockquote>
<table>
<thead>
<tr>
<th></th>
<th>发行版本</th>
<th>命令</th>
<th>功能</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>GETEX</td>
<td>6.2.0</td>
<td><strong>GETEX</strong> key [<strong>EX</strong> seconds |<strong>PX</strong> milliseconds |<strong>EXAT</strong> unix-time-seconds |<strong>PXAT</strong> unix-time-milliseconds |<strong>PERSIST</strong>]</td>
<td>查&amp;删</td>
<td>- <strong>EX</strong> seconds：指定过期秒数<br>- <strong>PX</strong> milliseconds：指定过期毫秒数<br>- <strong>EXAT</strong> timestamp-seconds：指定unix某时间点后多少秒过期<br>- <strong>PXAT</strong> timestamp-milliseconds：指定unix某时间点后多少毫秒过期<br>- <strong>PERSIST</strong>：删除过期时间</td>
</tr>
<tr>
<td>LCS</td>
<td>7.0.0</td>
<td><strong>LCS</strong> key1 key2 [LEN] [<strong>IDX</strong>] [<strong>MINMATCHLEN</strong> len] [<strong>WITHMATCHLEN</strong>]</td>
<td>查</td>
<td>实现最长公共子序列算法。匹配是从最后一个key到第一个key产生的。<br><br>[<strong>LEN</strong>]：最长匹配字符串长度<br>[<strong>IDX</strong>]：返回一个数组。其中包含 LCS匹配结果长度、两个字符串匹配上的开始和结束偏移量<br>[<strong>MINMATCHLEN</strong> len] ：最短匹配字符串长度<br>[<strong>WITHMATCHLEN</strong>]：与IDX一起使用，返回最长公共子字符串的长度</td>
</tr>
</tbody>
</table>
<blockquote>
<p>详解</p>
</blockquote>
<ol>
<li>
<p><span id="Order_LCS"><strong>LCS</strong> key1 key2 [LEN] [<strong>IDX</strong>] [<strong>MINMATCHLEN</strong> len] [<strong>WITHMATCHLEN</strong>] （longest contain substring）</span></p>
<p>LCS 命令实现最长公共子序列算法。请注意，这与最长的常见字符串算法不同，因为字符串中的匹配字符不需要是连续的</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> MSET key1 ohmytext key2 mynewtext
OK<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>a. 获取匹配结果</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> LCS key1 key2
<span class="token string">"mytext"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>b. 有时我们只需要匹配的长度：LEN</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> LCS key1 key2 LEN
<span class="token string">"6"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>c. 获取匹配的详细情况：IDX（LEN 和 IDX 不可同时存在）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> LCS key1 key2 IDX
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"matches"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
         <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">7</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">5</span>
         <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">8</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>
         <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
         <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"len"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">6</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>然而，通常非常有用的是知道每个字符串中的匹配位置：<strong>匹配是从最后一个到第一个产生的</strong></p>
<p>上面的数组意味着第一个匹配项（数组的第二个元素）在第一个字符串的位置 2-3 和第二个字符串的 0-1 之间。然后是 4-7 和 5-8 之间。</p>
<p>要将匹配列表限制为给定最小长度的匹配列表：<code>MINMATCHLEN 4</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> LCS key1 key2 IDX MINMATCHLEN <span class="token number">4</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"matches"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
         <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">7</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">5</span>
         <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">8</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"len"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">6</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>匹配列表展示匹配长度：<code>WITHMATCHLEN</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> LCS key1 key2 IDX MINMATCHLEN <span class="token number">4</span> WITHMATCHLEN
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"matches"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
         <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">7</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">5</span>
         <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">8</span>
      <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"len"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">6</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p>如果没有修饰符，则返回表示<strong>最长</strong>公共子字符串的字符串。</p>
</li>
<li>
<p>当<code>LEN</code>给出命令返回最长公共子字符串的长度。</p>
</li>
<li>
<p>当<code>IDX</code>给出该命令时，返回一个数组。</p>
<p>len：包含 LCS匹配结果长度</p>
<p>matches：两个字符串匹配上的开始和结束偏移量。当<code>WITHMATCHLEN</code>给出每个表示匹配的数组时，也将具有匹配的长度</p>
</li>
</ul>
</li>
</ol>
<h1>List</h1>
<p>Redis 列表是字符串值的链表。</p>
<p>Redis 列表经常用于：</p>
<ul>
<li>实现堆栈和队列。</li>
<li>为后台工作系统构建队列管理。</li>
</ul>
<p>双向链表：LPUSH命令将一个新元素添加到列表的左侧（头部），而该RPUSH命令将一个新元素添加到列表的右侧（尾部）</p>
<p>使用列表的技巧</p>
<ul>
<li>lpush+lpop = Stack(栈)</li>
<li>lpush+rpop = Queue（队列）</li>
<li>lpush+ltrim = Capped Collection（有限集合）</li>
<li>lpush+brpop = Message Queue（消息队列）</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">命令</th>
<th style="text-align:left">使用</th>
<th style="text-align:left">功能</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">LPUSH</td>
<td style="text-align:left">LPUSH <em>key</em> value [value …]</td>
<td style="text-align:left">增</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">LPOP</td>
<td style="text-align:left">LPOP key</td>
<td style="text-align:left">删</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">LPUSHX</td>
<td style="text-align:left">LPUSHX <em>key</em> value [value …]</td>
<td style="text-align:left">增</td>
<td>当 key 不存在时不会进行任何操作</td>
</tr>
<tr>
<td style="text-align:left">LSET</td>
<td style="text-align:left">LSET <em>key</em> index value</td>
<td style="text-align:left">改</td>
<td>修改指定位置元素</td>
</tr>
<tr>
<td style="text-align:left">LINSERT</td>
<td style="text-align:left">LINSERT key &lt;BEFORE |AFTER&gt; pivot element</td>
<td style="text-align:left">查&amp;增</td>
<td>功能： 在参考值pivot 之前或之后，将元素插入存储在 key 处的列表中。<br>-  当key不存在时，认为是空列表，不进行任何操作。 <br>- 当key存在，但不包含值pivot 时返回错误。<br><br>返回：  插入操作后列表的长度，或者当未找到值主元时为 -1。<br>举例：<code>LINSERT mylist BEFORE "World" "There"</code></td>
</tr>
<tr>
<td style="text-align:left">LREM</td>
<td style="text-align:left">LREM <em>key</em> count value</td>
<td style="text-align:left">删</td>
<td>删除count个value。count 为负数，从列尾开始计算</td>
</tr>
<tr>
<td style="text-align:left">LTRIM</td>
<td style="text-align:left">LTRIM <em>key</em> start stop</td>
<td style="text-align:left">删</td>
<td>截断列表元素，-1 是列表的最后一个元素</td>
</tr>
<tr>
<td style="text-align:left">LRANGE</td>
<td style="text-align:left">LRANGE <em>key</em> start stop</td>
<td style="text-align:left">查</td>
<td>获取列表指定范围数据：偏移量为负数，表示从列表末尾开始的偏移量。 <br>正整数（正数排名），负整数（倒数排名）<br>例如，-1 是列表的最后一个元素，-2 是倒数第二个元素，依此类推。</td>
</tr>
<tr>
<td style="text-align:left">LLEN</td>
<td style="text-align:left">LLEN <em>key</em></td>
<td style="text-align:left">查</td>
<td>获取列表元素个数</td>
</tr>
<tr>
<td style="text-align:left">LINDEX</td>
<td style="text-align:left">LINDEX <em>key</em> index</td>
<td style="text-align:left">查</td>
<td>获取列表第index个元素，-1 是列表的最后一个元素</td>
</tr>
<tr>
<td style="text-align:left">LPOS</td>
<td style="text-align:left">LPOS <em>key</em> element [RANK rank] [COUNT num-matches] [MAXLEN len]</td>
<td style="text-align:left">查</td>
<td>查找列表元素（发布版本：6.0.6） <br>[RANK rank] ： 指定要返回的第一个元素的“排名”，正整数（正数排名），负整数（倒数排名）。<br>[COUNT num-matches]：总共返回 num-matches个目标元素<br>[MAXLEN len]：最大筛查次数</td>
</tr>
<tr>
<td style="text-align:left">BLPOP</td>
<td style="text-align:left">BLPOP <em>key [key …]</em> timeout</td>
<td style="text-align:left">删</td>
<td>它是 LPOP 的阻塞版本。<br> 当没有任何元素可以从任何给定列表中弹出时，它会阻塞连接，直到超时后返回 null</td>
</tr>
<tr>
<td style="text-align:left">RPUSH</td>
<td style="text-align:left">RPUSH <em>key</em> value [value …]</td>
<td style="text-align:left">增</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">RPUSHX</td>
<td style="text-align:left">RPUSHX <em>key</em> value [value …]</td>
<td style="text-align:left">增</td>
<td>当 key 不存在时不会进行任何操作</td>
</tr>
<tr>
<td style="text-align:left">RPOP</td>
<td style="text-align:left">RPOP <em>key</em></td>
<td style="text-align:left">删</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">RPOPLPUSH</td>
<td style="text-align:left">RPOPLPUSH <em>source</em> <em>destination</em></td>
<td style="text-align:left">删</td>
<td>删除列表中的最后一个元素，将其添加到另一个列表并返回</td>
</tr>
<tr>
<td style="text-align:left">BRPOP</td>
<td style="text-align:left">BRPOP <em>key [key …]</em> timeout</td>
<td style="text-align:left">删</td>
<td>它是 RPOP 的阻塞版本</td>
</tr>
</tbody>
</table>
<blockquote>
<p>其他（6.0.6以下版本不支持）</p>
</blockquote>
<table>
<thead>
<tr>
<th>命令</th>
<th>使用</th>
<th>发行版本</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>LMOVE</td>
<td><strong>LMOVE</strong> <em>source  destination</em> <strong>LEFT |RIGHT   LEFT|RIGHT</strong></td>
<td>6.2.0</td>
<td>从列表中弹出一个元素，将其推送到另一个列表并返</td>
</tr>
<tr>
<td>LMPOP</td>
<td><strong>LMPOP</strong> numkeys <em>key [key …]</em> &lt;<strong>LEFT |RIGHT</strong>&gt; [<strong>COUNT</strong> count]</td>
<td>7.0.0</td>
<td>从提供的键名列表中的第一个非空列表键中弹出一个或多个元素。</td>
</tr>
<tr>
<td>BLMPOP</td>
<td><strong>BLMPOP</strong> timeout numkeys <em>key [key …]</em> &lt;<strong>LEFT |RIGHT</strong>&gt; [<strong>COUNT</strong> count]</td>
<td>7.0.0</td>
<td>它是 LMPOP 的阻塞版本</td>
</tr>
<tr>
<td>BLMOVE</td>
<td><strong>BLMOVE</strong>  <em>source  destination</em> &lt;<strong>LEFT |RIGHT</strong>&gt; &lt;<strong>LEFT |RIGHT</strong>&gt; timeout</td>
<td>6.2.0</td>
<td>它是 LMOVE 的阻塞版本</td>
</tr>
</tbody>
</table>
<h1>Hash</h1>
<p>Redis 哈希是结构为字段值对集合的记录类型。您可以使用散列来表示基本对象并存储计数器分组等。</p>
<table>
<thead>
<tr>
<th style="text-align:left">命令</th>
<th style="text-align:left">使用</th>
<th style="text-align:left">功能</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">HEXISTS</td>
<td style="text-align:left">HEXISTS <em>key</em> field</td>
<td style="text-align:left">查</td>
<td>查询 key.field 是否存在，存在返回0，不存在返回1</td>
</tr>
<tr>
<td style="text-align:left">HGET</td>
<td style="text-align:left">HGET <em>key</em> field</td>
<td style="text-align:left">查</td>
<td>获取指定键值对</td>
</tr>
<tr>
<td style="text-align:left">HMGET</td>
<td style="text-align:left">HMGET <em>key</em> field [field …]</td>
<td style="text-align:left">查</td>
<td>获取多个字段值</td>
</tr>
<tr>
<td style="text-align:left">HGETALL</td>
<td style="text-align:left">HGETALL <em>key</em></td>
<td style="text-align:left">查</td>
<td>获取所有键值对数据</td>
</tr>
<tr>
<td style="text-align:left">HINCRBY</td>
<td style="text-align:left">HINCRBY <em>key</em> field increment</td>
<td style="text-align:left">改</td>
<td>将hash 的 field字段的整数值增加给定的数字</td>
</tr>
<tr>
<td style="text-align:left">HINCRBYFLOAT</td>
<td style="text-align:left">HINCRBYFLOAT <em>key</em> field increment</td>
<td style="text-align:left">改</td>
<td>将hash 的 field字段的浮点值增加给定的数量</td>
</tr>
<tr>
<td style="text-align:left">HKEYS</td>
<td style="text-align:left">HKEYS <em>key</em></td>
<td style="text-align:left">查</td>
<td>获取hash 中的所有key</td>
</tr>
<tr>
<td style="text-align:left">HLEN</td>
<td style="text-align:left">HLEN <em>key</em></td>
<td style="text-align:left">查</td>
<td>键值对个数</td>
</tr>
<tr>
<td style="text-align:left">HSET</td>
<td style="text-align:left">HSET <em>key</em> field value</td>
<td style="text-align:left">增</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">HMSET</td>
<td style="text-align:left">HMSET <em>key</em> field value [field value…]</td>
<td style="text-align:left">增</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">HSETNX</td>
<td style="text-align:left">HSETNX <em>key</em> field value [field value…]</td>
<td style="text-align:left">增</td>
<td>如果 key field 都已存在时不会进行任何操作</td>
</tr>
<tr>
<td style="text-align:left">HSTRLEN</td>
<td style="text-align:left">HSTRLEN <em>key</em> field</td>
<td style="text-align:left">查</td>
<td>获取 key.field的value的长度</td>
</tr>
<tr>
<td style="text-align:left">HVALS</td>
<td style="text-align:left">HVALS <em>key</em></td>
<td style="text-align:left">查</td>
<td>获取hash 中的所有value</td>
</tr>
<tr>
<td style="text-align:left">HSCAN</td>
<td style="text-align:left">HSCAN <em>key</em> cursor [MATCH pattern] [COUNT count]</td>
<td style="text-align:left">查</td>
<td>使用方法方法可以参考<a href="#Order_SCAN">SCAN</a></td>
</tr>
<tr>
<td style="text-align:left">HDEL</td>
<td style="text-align:left">HDEL <em>key</em> field [field …]</td>
<td style="text-align:left">删</td>
<td>删除一个或者多个Hash表的键值对</td>
</tr>
</tbody>
</table>
<blockquote>
<p>其他（6.0.6以下版本不支持）</p>
</blockquote>
<table>
<thead>
<tr>
<th>命令</th>
<th>发行版本</th>
<th>使用</th>
<th>功能</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>HRANDFIELD</td>
<td>6.2.0</td>
<td><strong>HRANDFIELD</strong> key [count [<strong>WITHVALUES</strong>]]</td>
<td>查</td>
<td>从哈希中获取一个或多个随机字段<br>[<strong>WITHVALUES</strong>]：返回结果包含value</td>
</tr>
</tbody>
</table>
<p>实战场景</p>
<ul>
<li>缓存：相比String更节省空间，能直观的维护缓存信息，如用户信息，视频信息等。</li>
</ul>
<h1>Set：无序集合</h1>
<p>Redis 集是唯一字符串（成员）的无序集合。您可以使用 Redis 集高效地：</p>
<ul>
<li>跟踪唯一项目（例如，跟踪访问给定博客文章的所有唯一 IP 地址）</li>
<li>表示关系（例如，具有给定角色的所有用户的集合）</li>
<li>执行常见的集合运算，例如交集、并集和差集</li>
</ul>
<p><strong>实战场景</strong></p>
<ul>
<li><strong>标签</strong>（tag）,给用户添加标签，或者用户给消息添加标签，这样有同一标签或者类似标签的可以给推荐关注的事或者关注的人。</li>
<li><strong>点赞，或点踩，收藏等</strong>，可以放到set中实现</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">命令</th>
<th style="text-align:left">使用</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">SADD</td>
<td style="text-align:left">SADD <em>key</em> member [member …]</td>
<td style="text-align:left">增</td>
<td style="text-align:left">向集合中添加一个或多个成员</td>
</tr>
<tr>
<td style="text-align:left">SCARD</td>
<td style="text-align:left">SCARD <em>key</em></td>
<td style="text-align:left">查</td>
<td style="text-align:left">集合中元素个数</td>
</tr>
<tr>
<td style="text-align:left">SDIFF</td>
<td style="text-align:left">SDIFF <em>key [key …]</em></td>
<td style="text-align:left">集合：补</td>
<td style="text-align:left">取多个集合的差分（其他集合中都没有的元素）</td>
</tr>
<tr>
<td style="text-align:left">SDIFFSTORE</td>
<td style="text-align:left">SDIFFSTORE <em>destination</em> <em>key [key …]</em></td>
<td style="text-align:left">集合：补&amp;存</td>
<td style="text-align:left">取多个集合的差分, 并将结果集存储在一个集合中</td>
</tr>
<tr>
<td style="text-align:left">SINTER</td>
<td style="text-align:left">SINTER <em>key [key …]</em></td>
<td style="text-align:left">集合：交</td>
<td style="text-align:left">取多个集合的交集并返回 <br>INTER 为 Intersect /ˌɪntəˈsekt/ 的缩写</td>
</tr>
<tr>
<td style="text-align:left">SINTERSTORE</td>
<td style="text-align:left">SINTERSTORE <em>destination</em> <em>key [key …]</em></td>
<td style="text-align:left">集合：交&amp;存</td>
<td style="text-align:left">取多个集合的交集并将结果集存储在一个集合中（destination）</td>
</tr>
<tr>
<td style="text-align:left">SISMEMBER</td>
<td style="text-align:left">SISMEMBER <em>key</em> member</td>
<td style="text-align:left">查</td>
<td style="text-align:left">检查一个元素是否存在</td>
</tr>
<tr>
<td style="text-align:left">SMEMBERS</td>
<td style="text-align:left">SMEMBERS <em>key</em></td>
<td style="text-align:left">查</td>
<td style="text-align:left">返回所有元素</td>
</tr>
<tr>
<td style="text-align:left">SMOVE</td>
<td style="text-align:left">SMOVE <em>source destination</em> member</td>
<td style="text-align:left">查&amp;移动</td>
<td style="text-align:left">将集合source 中的元素member移动到集合destination中</td>
</tr>
<tr>
<td style="text-align:left">SPOP</td>
<td style="text-align:left">SPOP key [count]</td>
<td style="text-align:left">查&amp;删</td>
<td style="text-align:left">从集合中移除并返回一个或多个（count）随机成员</td>
</tr>
<tr>
<td style="text-align:left">SRANDMEMBER</td>
<td style="text-align:left">SRANDMEMBER key [count]</td>
<td style="text-align:left">查</td>
<td style="text-align:left">从集合中获取一个或多个（count）随机成员，元素在集合中依然存在</td>
</tr>
<tr>
<td style="text-align:left">SREM</td>
<td style="text-align:left">SREM <em>key</em> member [member …]</td>
<td style="text-align:left">删</td>
<td style="text-align:left">从SET中删除一个或者多个元素</td>
</tr>
<tr>
<td style="text-align:left">SUNION</td>
<td style="text-align:left">SUNION <em>key [key …]</em></td>
<td style="text-align:left">集合：并</td>
<td style="text-align:left">取多个集合的并集</td>
</tr>
<tr>
<td style="text-align:left">SUNIONSTORE</td>
<td style="text-align:left">SUNIONSTORE <em>destination</em> <em>key [key …]</em></td>
<td style="text-align:left">集合：并&amp;存</td>
<td style="text-align:left">取多个集合的并集并将结果集存储在一个集合中（destination）</td>
</tr>
<tr>
<td style="text-align:left">SSCAN</td>
<td style="text-align:left">SSCAN <em>key</em> cursor [MATCH pattern] [COUNT count]</td>
<td style="text-align:left">遍历查</td>
<td style="text-align:left">参考<a href="#Order_SCAN">SCAN</a></td>
</tr>
</tbody>
</table>
<blockquote>
<p>其他（6.0.6以下版本不支持）</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:left">命令</th>
<th style="text-align:left">使用</th>
<th style="text-align:left">发行版本</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">SINTERCARD</td>
<td style="text-align:left">SINTERCARD numkeys <em>key [key …]</em> [LIMIT limit]</td>
<td style="text-align:left">7.0.0</td>
<td style="text-align:left">集合：交</td>
<td style="text-align:left">获取两个集合的交集数量<br>[LIMIT  limit]：最大交集量 <br><code>SINTERCARD 2 testset testset1返回19</code> 两个集合的交集量容量为19 <br><code>SINTERCARD 2 testset testset1 limit 10 </code>返回10</td>
</tr>
<tr>
<td style="text-align:left">SMISMEMBER</td>
<td style="text-align:left">SMISMEMBER <em>key</em> member [member …]</td>
<td style="text-align:left">6.2.0</td>
<td style="text-align:left">查</td>
<td style="text-align:left">返回每个成员是否是存储在 key  集合的成员（多个元素的存在的查询） <br>返回与指定的member顺序一致的数组</td>
</tr>
</tbody>
</table>
<h1>Zset : 有序集合</h1>
<p>Redis 排序集是由<strong>相关分数</strong>排序的唯一字符串（成员）的集合。当多个字符串具有相同的分数时，这些字符串按字典顺序排列。排序集的一些用例包括：</p>
<ul>
<li>
<p>排行榜。例如，您可以使用排序集轻松维护大型在线游戏中最高分的有序列表。</p>
</li>
<li>
<p>速率限制器。特别是，您可以使用排序集来构建滑动窗口速率限制器，以防止过多的 API 请求。</p>
</li>
</ul>
<p>Sorted Set 中的每个元素都与一个浮点值相关联，称为<code>score </code>。所以Sorted Set 也是一种Hash结构。</p>
<p>排序规则：</p>
<ul>
<li>
<p>如果 A 和 B 是具有不同分数的两个元素， A.score &gt; B.score，则 A &gt; B 。</p>
</li>
<li>
<p>如果 A 和 B 具有完全相同的分数，如果 A 字符串<code>在字典顺序上</code>大于 B 字符串，则 A &gt; B。A 和 B 字符串不能相等，因为排序集只有唯一元素</p>
</li>
</ul>
<p>实战场景</p>
<ul>
<li><strong>排行榜</strong>：小说视频等网站需要对用户上传的小说视频做排行榜，榜单可以按照用户关注数，更新时间，字数等打分，做排行。</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">命令</th>
<th style="text-align:left">使用</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">ZADD</td>
<td style="text-align:left">ZADD <em>key</em> [NX | XX] [GT | LT] [CH] [INCR]  <em>score member [score member   …]</em></td>
<td style="text-align:left">增</td>
<td style="text-align:left">为有序集合添加一个/多个元素，若元素存在，则修改元素的score<br> - <strong>XX</strong>:  只更新已经存在的元素。不添加新元素。<br>- <strong>NX</strong>:   只添加新元素。 不要更新已经存在的元素. <br>- <strong>LT</strong>:   如果新分数<strong>小于</strong>当前分数，则仅更新现有元素。 此标志不会阻止添加新元素。<br>- <strong>GT</strong>:  如果新分数<strong>大于</strong>当前分数，则仅更新现有元素。 此标志不会阻止添加新元素。<br>- <strong>CH</strong>:  通常ZADD的返回值只计算添加的新元素的数量，此命令将返回值则为更改的元素总数（CH 是 <em>changed</em> 的缩写），即：<strong>添加的新元素</strong>和<strong>已经存在且分数被更新的元素</strong>。  <br><strong>INCR</strong>:   此命令类似于<code>ZINCRBY</code>。在此模式下只能指定一个分数元素对。<br><br>注意: <strong>GT</strong>、<strong>LT</strong> 和 <strong>NX</strong> 选项是互斥的。</td>
</tr>
<tr>
<td style="text-align:left">ZCARD</td>
<td style="text-align:left">ZCARD <em>key</em></td>
<td style="text-align:left">查</td>
<td style="text-align:left">返回存储在 key 处的有序集合元素数 <br>card: cardinality 基数</td>
</tr>
<tr>
<td style="text-align:left">ZCOUNT</td>
<td style="text-align:left">ZCOUNT <em>key</em> min max</td>
<td style="text-align:left">查</td>
<td style="text-align:left">用给定值内的分数计算有序集合元素数（包含min 和 max）</td>
</tr>
<tr>
<td style="text-align:left">ZINCRBY</td>
<td style="text-align:left">ZINCRBY <em>key</em> increment member</td>
<td style="text-align:left">查&amp;改</td>
<td style="text-align:left">将存储在 key 的有序集合中的成员的分数按增量递增 <br>① 如果成员在排序集中不存在，则将其添加为增量作为其分数（就像它之前的分数是 0.0） <br>② 如果 key 不存在，则创建一个以指定成员为唯一成员的新排序集。</td>
</tr>
<tr>
<td style="text-align:left">ZLEXCOUNT</td>
<td style="text-align:left">ZLEXCOUNT <em>key</em> min max</td>
<td style="text-align:left">查</td>
<td style="text-align:left">该命令返回有序集合中指定字典范围内的元素个数。<br>① 当一个有序集合中的所有元素以相同的分数插入时，强制使用字典顺序<br>② min 和 max 的定义类似 <a href="#ORDER_ZRANGEBYLEX">ZRANGEBYLEX</a></td>
</tr>
<tr>
<td style="text-align:left">ZPOPMAX</td>
<td style="text-align:left">ZPOPMAX <em>key</em> [count]</td>
<td style="text-align:left">查&amp;删</td>
<td style="text-align:left"><code>从一个key，弹出多个成员</code><br>删除并返回存储在排序集（key）中得分最高的 count个成员。</td>
</tr>
<tr>
<td style="text-align:left">BZPOPMAX</td>
<td style="text-align:left">BZPOPMAX <em>key [key …]</em> timeout</td>
<td style="text-align:left">查&amp;删</td>
<td style="text-align:left"><code> 从多个key，弹出一个成员</code><br>从一个或多个排序集（key [key …]）删除并返回得分最高的成员<br>无数据，则阻塞等待，直到有一个key可用。</td>
</tr>
<tr>
<td style="text-align:left">ZPOPMIN</td>
<td style="text-align:left">ZPOPMIN <em>key</em> [count]</td>
<td style="text-align:left">查&amp;删</td>
<td style="text-align:left"><code>从一个key，弹出多个成员</code><br>删除并返回存储在 key 的排序集中得分最低的 count个 成员</td>
</tr>
<tr>
<td style="text-align:left">BZPOPMIN</td>
<td style="text-align:left">BZPOPMIN <em>key [key …]</em> timeout</td>
<td style="text-align:left">查&amp;删</td>
<td style="text-align:left"><code>从多个key，弹出一个成员</code><br>从一个或多个排序集中删除并返回得分最低的成员，或阻止，直到有一个可用</td>
</tr>
<tr>
<td style="text-align:left">ZRANGE</td>
<td style="text-align:left">ZRANGE <em>key</em> start stop [WITHSCORES]</td>
<td style="text-align:left">查</td>
<td style="text-align:left">有序集合，返回指定index范围的元素 <br>[WITHSCORES]：一并返回元素分值 <br>举例： <code>ZRANGE hackers 0 -1 WITHSCORES</code></td>
</tr>
<tr>
<td style="text-align:left">ZRANK</td>
<td style="text-align:left">ZRANK <em>key</em> member</td>
<td style="text-align:left">查</td>
<td style="text-align:left">返回 member 在存储在 key 的有序集合中的排名，分数从低到高排序。<br>排名（或索引）从 0 开始</td>
</tr>
<tr>
<td style="text-align:left">ZREVRANK</td>
<td style="text-align:left">ZREVRANK <em>key</em> member</td>
<td style="text-align:left">查</td>
<td style="text-align:left">返回 member 在存储在 key 的有序集合中的排名，分数从高到低排序。<br>排名（或索引）从 0 开始，这意味着得分最高的成员的排名为 0</td>
</tr>
<tr>
<td style="text-align:left">ZREM</td>
<td style="text-align:left">ZREM <em>key</em> member [member …]</td>
<td style="text-align:left">删</td>
<td style="text-align:left">从存储在 key 的排序集中删除指定的成员<br>不存在的成员将被忽略</td>
</tr>
<tr>
<td style="text-align:left">ZREMRANGEBYLEX</td>
<td style="text-align:left">ZREMRANGEBYLEX <em>key</em> min max</td>
<td style="text-align:left">删</td>
<td style="text-align:left">删除给定字典序范围内的元素（闭区间）</td>
</tr>
<tr>
<td style="text-align:left">ZREMRANGEBYRANK</td>
<td style="text-align:left">ZREMRANGEBYRANK <em>key</em> start stop</td>
<td style="text-align:left">删</td>
<td style="text-align:left">删除指定位置区间内的元素（闭区间）</td>
</tr>
<tr>
<td style="text-align:left">ZREMRANGEBYSCORE</td>
<td style="text-align:left">ZREMRANGEBYSCORE <em>key</em> min max</td>
<td style="text-align:left">删</td>
<td style="text-align:left">删除分数介于 min 和 max 之间的元素 （闭区间）</td>
</tr>
<tr>
<td style="text-align:left">ZSCORE</td>
<td style="text-align:left">ZSCORE <em>key</em> member</td>
<td style="text-align:left">查</td>
<td style="text-align:left">获取与排序集合中给定成员关联的分数</td>
</tr>
<tr>
<td style="text-align:left">ZSCAN</td>
<td style="text-align:left">ZSCAN <em>key</em> cursor [MATCH pattern] [COUNT count]</td>
<td style="text-align:left">查</td>
<td style="text-align:left">增量迭代排序集元素和相关分数。使用方法可以参考<a href="#Order_SCAN">SCAN</a></td>
</tr>
</tbody>
</table>
<blockquote>
<p>集合操作（6.0.6 之前）</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:left">命令</th>
<th>功能</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>ZINTERSTORE</strong> <em>destination</em> numkeys <em>key [key …]</em> [<strong>WEIGHTS</strong> weight   [weight …]] [<strong>AGGREGATE</strong> &lt;<strong>SUM</strong> |<strong>MIN</strong> |<strong>MAX</strong>&gt;]</td>
<td>交集</td>
<td style="text-align:left">计算多个有序集合的交集，并保存到destination 中。<br>[<strong>WEIGHTS</strong> weight   [weight …]] ：使用此选项，可以为每个输入排序集指定一个乘法因子。<br>① 每个输入排序集中的每个元素的分数在传递给聚合函数之前都会乘以该因子。<br>② 当未给出 WEIGHTS 时，乘法因子默认为 1。<br>[<strong>AGGREGATE</strong> &lt;<strong>SUM</strong> |<strong>MIN</strong> |<strong>MAX</strong>&gt;] : <em>destination</em> 中元素的分数的计算方式。默认为求和。</td>
</tr>
<tr>
<td style="text-align:left"><strong>ZUNIONSTORE</strong> <em>destination</em> numkeys <em>key [key …]</em> [<strong>WEIGHTS</strong> weight   [weight …]] [<strong>AGGREGATE</strong> &lt;<strong>SUM</strong> |<strong>MIN</strong> |<strong>MAX</strong>&gt;]</td>
<td>并集</td>
<td style="text-align:left">计算多个有序集合的并集，并保存到destination 中。<br>如果destination已经存在，它会被覆盖。<br><br>[<strong>WEIGHTS</strong> weight   [weight …]] ：使用此选项，可以为每个输入排序集指定一个乘法因子<br>① 每个输入排序集中的每个元素的分数在传递给聚合函数之前都会乘以该因子。<br>② 当未给出 WEIGHTS 时，乘法因子默认为 1。<br>[<strong>AGGREGATE</strong> &lt;<strong>SUM</strong> |<strong>MIN</strong> |<strong>MAX</strong>&gt;] : <em>destination</em> 中元素的分数的计算方式。默认为求和。</td>
</tr>
</tbody>
</table>
<blockquote>
<p>集合操作（6.0.6 之后）</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:left">命令</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">版本</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>ZINTER</strong> numkeys <em>key [key …]</em> [<strong>WEIGHTS</strong> weight [weight …]]   [<strong>AGGREGATE</strong> &lt;<strong>SUM</strong> |<strong>MIN</strong> |<strong>MAX</strong>&gt;] [<strong>WITHSCORES</strong>]</td>
<td style="text-align:left">交集</td>
<td style="text-align:left">6.2.0</td>
<td style="text-align:left">计算多个有序集合的交集，并返回</td>
</tr>
<tr>
<td style="text-align:left"><strong>ZUNION</strong> numkeys <em>key [key …]</em> [<strong>WEIGHTS</strong> weight [weight …]]   [<strong>AGGREGATE</strong> &lt;<strong>SUM</strong> |<strong>MIN</strong> |<strong>MAX</strong>&gt;] [<strong>WITHSCORES</strong>]</td>
<td style="text-align:left">并集</td>
<td style="text-align:left">6.2.0</td>
<td style="text-align:left">计算多个有序集合的并集，并返回</td>
</tr>
<tr>
<td style="text-align:left"><strong>ZDIFF</strong> numkeys <em>key [key …]</em> [<strong>WITHSCORES</strong>]</td>
<td style="text-align:left">补集</td>
<td style="text-align:left">6.2.0</td>
<td style="text-align:left">计算第一个集合比后面所有集合多出的元素，并返回<br>（比较逻辑和分值无关）</td>
</tr>
<tr>
<td style="text-align:left"><strong>ZDIFFSTORE</strong> <em>destination</em> numkeys <em>key [key …]</em></td>
<td style="text-align:left">补集</td>
<td style="text-align:left">6.2.0</td>
<td style="text-align:left">计算第一个集合比后面所有集合多出的元素，并存入destination<br>（比较逻辑和分值无关）</td>
</tr>
</tbody>
</table>
<blockquote>
<p>其他（6.0.6以下版本不支持）</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:left">命令</th>
<th style="text-align:left">使用</th>
<th style="text-align:left">发行版本</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">ZRANDMEMBER</td>
<td style="text-align:left"><strong>ZRANDMEMBER</strong> key [count [<strong>WITHSCORES</strong>]]</td>
<td style="text-align:left">6.2.0</td>
<td style="text-align:left">查</td>
<td style="text-align:left">从有序集合中返回一个或多个元素<br>如果提供的 count 参数为正，则返回不同元素的数组。数组的长度是计数或排序集的基数 (ZCARD)，以较低者为准。<br>如果以负数调用，则行为会发生变化，并且允许该命令多次返回相同的元素。在这种情况下，返回元素的数量是指定计数的绝对值。</td>
</tr>
<tr>
<td style="text-align:left">ZRANGE</td>
<td style="text-align:left"><strong>ZRANGE</strong> <em>key</em> start  stop [<strong>BYSCORE</strong> |<strong>BYLEX</strong>] [<strong>REV</strong>] [<strong>LIMIT</strong> offset count]   [<strong>WITHSCORES</strong>]</td>
<td style="text-align:left">6.2.0</td>
<td style="text-align:left">查</td>
<td style="text-align:left">此命令可以替换以下命令：<br><strong>ZREVRANGE、ZRANGEBYSCORE、ZREVRANGEBYSCORE、ZRANGEBYLEX 和 ZREVRANGEBYLEX</strong><br><br> [<strong>BYSCORE</strong> |<strong>BYLEX</strong>] ：根据分值查找/ 根据字典顺序<br><br><code>zrange hackers  + - bylex rev</code><br></td>
</tr>
<tr>
<td style="text-align:left">ZRANGESTORE</td>
<td style="text-align:left"><strong>ZRANGESTORE</strong> <em>dst  src</em> min max   [<strong>BYSCORE</strong> | <strong>BYLEX</strong>]   [<strong>REV</strong>]   [<strong>LIMIT</strong> offset   count]</td>
<td style="text-align:left">6.2.0</td>
<td style="text-align:left">查&amp;存</td>
<td style="text-align:left">ZRANGE 查询结果结果存储在目标键dst 中</td>
</tr>
<tr>
<td style="text-align:left">ZMSCORE</td>
<td style="text-align:left"><strong>ZMSCORE</strong> <em>key</em> member [member …]</td>
<td style="text-align:left">6.2.0</td>
<td style="text-align:left">查</td>
<td style="text-align:left">查询指定成员关联的分数<br>对于排序集中不存在的每个成员，返回一个 nil 值。</td>
</tr>
<tr>
<td style="text-align:left">ZINTERCARD</td>
<td style="text-align:left"><strong>ZINTERCARD</strong> numkeys <em>key [key …]</em> [<strong>LIMIT</strong> limit]</td>
<td style="text-align:left">7.0.0</td>
<td style="text-align:left">集合：交</td>
<td style="text-align:left">返回交集元素总量<br> [LIMIT limit]：默认为 0，表示无限制。<br>如果交集元素总量在计算过程中达到极限，算法将退出并将limit 作为交集总量<br><code>ZINTERCARD 2 zset1 zset2 LIMIT 1</code>:   <code>返回 1</code></td>
</tr>
<tr>
<td style="text-align:left">ZMPOP</td>
<td style="text-align:left"><strong>ZMPOP</strong> numkeys <em>key [key …]</em> &lt;<strong>MIN | MAX</strong>&gt; [<strong>COUNT</strong> count]</td>
<td style="text-align:left">7.0.0</td>
<td style="text-align:left">删</td>
<td style="text-align:left"><code>从多个key，弹出多个成员</code><br>从提供的键名列表中的第一个非空排序集中弹出一个或多个成员</td>
</tr>
<tr>
<td style="text-align:left">BZMPOP</td>
<td style="text-align:left"><strong>BZMPOP</strong> timeout numkeys <em>key [key …]</em> &lt;<strong>MIN | MAX&gt;</strong> [<strong>COUNT</strong> count]</td>
<td style="text-align:left">7.0.0</td>
<td style="text-align:left">删</td>
<td style="text-align:left"><code> 从多个key，弹出多个成员</code><br>有序集合中存在数据时返回，不存在时阻塞等待。<br>timeout：double数，时间单位为秒，设置为0时无期限等待</td>
</tr>
</tbody>
</table>
<blockquote>
<p>6.2.0之后已被弃用，被合并到ZRANGE</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:left">命令</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>ZREVRANGE</strong>  <em>key</em> start stop [<strong>WITHSCORES</strong>]</td>
<td style="text-align:left">查</td>
<td style="text-align:left">按照<strong>分值降序</strong>后，返回有序集合中指定<strong>index</strong>范围的元素</td>
</tr>
<tr>
<td style="text-align:left"><span id="ORDER_ZRANGEBYLEX"><strong>ZRANGEBYLEX</strong> <em>key</em> min max [<strong>LIMIT</strong> offset count]</span></td>
<td style="text-align:left">查</td>
<td style="text-align:left">该命令返回有序集合中指定<strong>字典</strong>范围内的元素<br>① 当排序集中的所有元素<strong>以相同的分数</strong>插入时，使用字典顺序，<br>② 此命令返回排序集中的所有元素在 key 处，其值介于 min 和 max 之间。<br>③ 如果排序集中的元素具有不同的分数，则返回的元素是未指定的<br><code> ZRANGEBYLEX  hackers - +</code> <br><code> ZRANGEBYLEX  hackers - + LIMIT 2 3</code>  <br><code>ZRANGEBYLEX  hackers [A [Z</code>：包含<br><code>ZRANGEBYLEX  hackers (A (Z</code>：不包含</td>
</tr>
<tr>
<td style="text-align:left"><strong>ZREVRANGEBYLEX</strong> <em>key</em> max min [<strong>LIMIT</strong> offset count]</td>
<td style="text-align:left">查</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left"><strong>ZRANGEBYSCORE</strong> <em>key</em> min max [<strong>WITHSCORES</strong>] [<strong>LIMIT</strong> offset count]</td>
<td style="text-align:left">查</td>
<td style="text-align:left">按照<strong>分值降序</strong>后，返回有序集合中指定分值范围的元素<br>举例：<code>zrangebyscore hackers -inf 1950</code><br>==-inf==: 表示负无穷 <strong>infinity</strong> [ɪnˈfɪnəti]</td>
</tr>
<tr>
<td style="text-align:left"><strong>ZREVRANGEBYSCORE</strong> <em>key</em> max min [<strong>WITHSCORES</strong>] [<strong>LIMIT</strong> offset count]</td>
<td style="text-align:left">查</td>
<td style="text-align:left"></td>
</tr>
</tbody>
</table>
<h1>HyperLogLogs（基数统计）</h1>
<blockquote>
<p>Redis 2.8.9 版本更新了 Hyperloglog 数据结构</p>
</blockquote>
<ul>
<li>
<p><strong>什么是基数？</strong></p>
<p>举个例子，A = {1, 2, 3, 4, 5}， B = {3, 5, 6, 7, 9}；那么基数（不重复的元素）= 1, 2, 4, 6, 7, 9； （允许容错，即可以接受一定误差）</p>
</li>
<li>
<p><strong>HyperLogLogs 基数统计用来解决什么问题</strong>？</p>
<p>这个结构可以非常省内存的去统计各种计数，比如注册 IP 数、每日访问 IP 数、页面实时UV、在线用户数，共同好友数等。</p>
</li>
<li>
<p><strong>它的优势体现在哪</strong>？</p>
<p>一个大型的网站，每天 IP 比如有 100 万，粗算一个 IP 消耗 15 字节，那么 100 万个 IP 就是 15M。而 HyperLogLog 在 Redis 中每个键占用的内容都是 12K，理论存储近似接近 2^64 个值，不管存储的内容是什么，它一个基于基数估算的算法，只能比较准确的估算出基数，可以使用少量固定的内存去存储并识别集合中的唯一元素。而且这个估算的基数并不一定准确，是一个带有 0.81% 标准错误的近似值（对于可以接受一定容错的业务场景，比如IP数统计，UV等，是可以忽略不计的）</p>
</li>
<li>
<p><strong>相关命令使用</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># PFADD key [element [element ...]]</span>
<span class="token operator">&gt;</span> PFADD key1 a b c d e f g h i	<span class="token comment"># 创建第一组元素</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>

<span class="token comment"># 统计元素的基数数量</span>
<span class="token comment"># PFCOUNT key [key ...]</span>
<span class="token operator">&gt;</span> PFCOUNT key1					
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">9</span>

<span class="token comment"># 创建第二组元素</span>
<span class="token operator">&gt;</span> PFADD key2 c j k l m e g a		
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token operator">&gt;</span> PFCOUNT key2
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">8</span>

<span class="token comment"># 合并两组：key1 key2 -&gt; key3 并集</span>
<span class="token comment"># PFMERGE destkey sourcekey [sourcekey ...]</span>
<span class="token operator">&gt;</span> PFMERGE key3 key1 key2			
OK
<span class="token operator">&gt;</span> pfcount key3
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">13</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h1>Bitmap （位存储）</h1>
<blockquote>
<p>Bitmap 即位图数据结构，都是操作二进制位来进行记录，只有0 和 1 两个状态。</p>
</blockquote>
<ul>
<li>
<p><strong>用来解决什么问题</strong></p>
<p>比如：统计用户信息，活跃，不活跃； 登录，未登录；打卡，不打卡； <strong>两个状态的，都可以使用 Bitmaps</strong>！</p>
<p>如果存储一年的打卡状态需要多少内存呢？ 365 天 = 365 bit 1字节 = 8bit 46 个字节左右</p>
</li>
<li>
<p><strong>相关命令使用</strong></p>
<p>使用bitmap 来记录 周一到周日的打卡！ 周一：1 周二：0 周三：0 周四：1 …</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># SETBIT key offset value</span>
<span class="token operator">&gt;</span> setbit sign <span class="token number">0</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token operator">&gt;</span> setbit sign <span class="token number">1</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token operator">&gt;</span> setbit sign <span class="token number">2</span> <span class="token number">0</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token operator">&gt;</span> setbit sign <span class="token number">3</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token operator">&gt;</span> setbit sign <span class="token number">4</span> <span class="token number">0</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token operator">&gt;</span> setbit sign <span class="token number">5</span> <span class="token number">0</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token operator">&gt;</span> setbit sign <span class="token number">6</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>查看某一天是否有打卡</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># GETBIT key offset</span>
<span class="token operator">&gt;</span> getbit sign <span class="token number">3</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token operator">&gt;</span> getbit sign <span class="token number">5</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>统计操作，统计 打卡的天数</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># BITCOUNT key [start end [BYTE | BIT]]</span>
<span class="token comment"># BITCOUNT 统计的是二进制后的数据</span>
<span class="token operator">&gt;</span> bitcount sign <span class="token comment"># 统计这周的打卡记录，就可以看到是否有全勤！</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>


<span class="token comment"># 111001101001100010101111</span>
<span class="token operator">&gt;</span> SET <span class="token builtin class-name">test</span> 谳
OK
<span class="token operator">&gt;</span> BITCOUNT <span class="token builtin class-name">test</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">12</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<ol>
<li>
<p>GETBIT key offset</p>
</li>
<li>
<p>SETBIT key offset value</p>
</li>
<li>
<p>BITCOUNT key [start end [BYTE | BIT]]</p>
</li>
<li>
<p>BITOP operation destkey key [key …] ： 在多个键(包含字符串值)之间执行位操作，并将结果存储在目标键中</p>
<pre class="line-numbers language-none"><code class="language-none">BITOP AND destkey srckey1 srckey2 srckey3 ... srckeyN
BITOP OR destkey srckey1 srckey2 srckey3 ... srckeyN
BITOP XOR destkey srckey1 srckey2 srckey3 ... srckeyN
BITOP NOT destkey srckey<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p>BITPOS key bit [start [end [BYTE | BIT]]]   返回字符串中第一个位设置为1或0的位置</p>
</li>
</ol>
<h1>Geospatial (地理位置)</h1>
<blockquote>
<p>这个功能可以推算地理位置的信息: 两地之间的距离, 方圆几里的人</p>
<ul>
<li>有效的经度从-180度到180度。</li>
<li>有效的纬度从-85.05112878度到85.05112878度。</li>
</ul>
</blockquote>
<h2 id="GEOADD：添加地理位置">GEOADD：添加地理位置</h2>
<p><strong>GEOADD</strong> key [NX | XX] [CH] <font color="blue">longitude latitude member </font> <font color="green">[longitude<br>
latitude member …]</font></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> GEOADD china:city <span class="token number">118.76</span> <span class="token number">32.04</span> nanjing <span class="token number">112.55</span> <span class="token number">37.86</span> taiyuan <span class="token number">123.43</span> <span class="token number">41.80</span> shenyang
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token operator">&gt;</span> GEOADD china:city <span class="token number">144.05</span> <span class="token number">22.52</span> shengzhen <span class="token number">120.16</span> <span class="token number">30.24</span> hangzhou <span class="token number">108.96</span> <span class="token number">34.26</span> xian
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>规则</strong></p>
<p>两级无法直接添加，我们一般会下载城市数据(这个网址可以查询 GEO： <a target="_blank" rel="noopener" href="http://www.jsons.cn/lngcode">http://www.jsons.cn/lngcode</a>)！</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 当坐标位置超出上述指定范围时，该命令将会返回一个错误。</span>
<span class="token operator">&gt;</span> GEOADD china:city <span class="token number">39.90</span> <span class="token number">116.40</span> beijin
<span class="token punctuation">(</span>error<span class="token punctuation">)</span> ERR invalid longitude,latitude pair <span class="token number">39.900000</span>,116.400000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://hmxyl-image.oss-cn-hangzhou.aliyuncs.com/note/image-20230207154102639-1678135967819-87.png" alt="image-20230207154102639"></p>
<blockquote>
<p>存储：将二维的经纬度转换为一维的HASH 值</p>
</blockquote>
<h2 id="GEOPOS：获取指定的成员的经度和纬度">GEOPOS：获取指定的成员的经度和纬度</h2>
<p>获得当前定位, 一定是一个坐标值</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> GEOPOS china:city taiyuan nanjing
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"112.54999905824661255"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"37.86000073876942196"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"118.75999957323074341"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"32.03999960287850968"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="GEODIST：计算两点之间的距离">GEODIST：计算两点之间的距离</h2>
<p><strong>GEODIST</strong> key member1 member2  [M | KM | FT | MI]</p>
<ul>
<li>m</li>
<li>km</li>
<li>mi 英里</li>
<li>ft 英尺</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> GEODIST china:city taiyuan shenyang KM
<span class="token string">"1026.4391"</span>

<span class="token comment"># 位置不存在，返回为空</span>
<span class="token operator">&gt;</span> GEODIST china:city chengdou shenyang KM
<span class="token punctuation">(</span>nil<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="GEOHASH：-该命令返回11个字符的HASH字符串">GEOHASH： 该命令返回11个字符的HASH字符串</h2>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> GEOHASH china:city taiyuan shenyang
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"ww8p3hhqmp0"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"wxrvb9qyxk0"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="GEOSEARCH：地理位置查询">GEOSEARCH：地理位置查询</h2>
<blockquote>
<p>版本6.2.0 之后新增</p>
</blockquote>
<p><strong>GEOSEARCH</strong> key <font color="blue">&lt;<strong>FROMMEMBER</strong> member | <strong>FROMLONLAT</strong> longitude latitude&gt;</font><br>
<font color="green">&lt;<strong>BYRADIUS</strong> radius &lt;M | KM | FT | MI&gt; | BYBOX width height &lt;M | KM |<br>
FT | MI&gt;&gt;</font>  <strong>[ASC | DESC]</strong> <font color="blue"> [<strong>COUNT</strong> count [<strong>ANY</strong>]]</font> [WITHCOORD] [<strong>WITHDIST</strong>]<br>
[<strong>WITHHASH</strong>]</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> GEOSEARCH china:city FROMMEMBER nanjing BYRADIUS <span class="token number">10000</span> KM 
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"nanjing"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"taiyuan"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"shenyang"</span>

<span class="token operator">&gt;</span> GEOSEARCH china:city FROMMEMBER nanjing BYRADIUS <span class="token number">10000</span> KM WITHDIST
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"nanjing"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"0.0000"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"taiyuan"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"859.5256"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"shenyang"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"1161.7864"</span>
   
<span class="token operator">&gt;</span> GEOSEARCH china:city FROMMEMBER nanjing BYRADIUS <span class="token number">10000</span> KM WITHDIST WITHCOORD
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"nanjing"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"0.0000"</span>
   <span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"118.75999957323074341"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"32.03999960287850968"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"taiyuan"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"859.5256"</span>
   <span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"112.54999905824661255"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"37.86000073876942196"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"shenyang"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"1161.7864"</span>
   <span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"123.42999905347824097"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"41.79999919077864234"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="GEOSEARCHSTORE">GEOSEARCHSTORE</h2>
<p><strong>GEOSEARCHSTORE</strong> destination source  <font color="blue">&lt;<strong>FROMMEMBER</strong> member | <strong>FROMLONLAT</strong> longitude latitude&gt;</font><br>
<font color="green">&lt;<strong>BYRADIUS</strong> radius &lt;M | KM | FT | MI&gt; | BYBOX width height &lt;M | KM |<br>
FT | MI&gt;&gt;</font>  <strong>[ASC | DESC]</strong> <font color="blue"> [<strong>COUNT</strong> count [<strong>ANY</strong>]]</font> [<strong>STOREDIST</strong>]</p>
<p>此命令类似于<code>GEOSEARCH</code>，但将结果存储在目标键中。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> GEOSEARCHSTORE <span class="token builtin class-name">test</span> china:city FROMMEMBER nanjing BYRADIUS <span class="token number">10000</span> KM
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://hmxyl-image.oss-cn-hangzhou.aliyuncs.com/note/image-20230207161213311-1678135967819-89.png" alt="image-20230207161213311"></p>
<h2 id="GEORADIUS：获得所有附近的人的地址-定位-通过半径来查询（6-2-0之后弃用）">GEORADIUS：获得所有附近的人的地址, 定位, 通过半径来查询（6.2.0之后弃用）</h2>
<blockquote>
<p>从Redis版本6.2.0开始，此命令被认为已弃用。可将其替换为<code>GEOSEARCH</code>和<code>GEOSEARCHSTORE</code>，并使用<code>BYRADIUS</code>参数</p>
</blockquote>
<p><strong>GEORADIUS</strong> key longitude latitude radius  <strong>&lt;M | KM | FT | MI&gt;</strong><br>
[<strong>WITHCOORD</strong>] [<strong>WITHDIST</strong>] [<strong>WITHHASH</strong>] [<strong>COUNT</strong> count [<strong>ANY</strong>]] [<strong>ASC</strong> | <strong>DESC</strong>]<br>
[<strong>STORE</strong> key] [<strong>STOREDIST</strong> key]</p>
<ul>
<li><strong>WITHDIST</strong> : 返回距离</li>
<li><strong>WITHCOORD</strong>：返回坐标</li>
<li><strong>WITHHASH</strong>：返回坐标的HASH值（ZSET的SCORE值）</li>
<li><strong>COUNT</strong> count：显示结果的数量</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 以 100,30 这个坐标为中心, 寻找半径为1000km的城市</span>
<span class="token operator">&gt;</span> GEORADIUS china:city <span class="token number">110</span> <span class="token number">30</span> <span class="token number">1000</span> km			
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"xian"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"hangzhou"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"nanjing"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"taiyuan"</span>
<span class="token operator">&gt;</span> GEORADIUS china:city <span class="token number">110</span> <span class="token number">30</span> <span class="token number">500</span> km
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"xian"</span>
<span class="token operator">&gt;</span> GEORADIUS china:city <span class="token number">110</span> <span class="token number">30</span> <span class="token number">500</span> km WITHDIST
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"xian"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"483.8340"</span>
<span class="token operator">&gt;</span> GEORADIUS china:city <span class="token number">110</span> <span class="token number">30</span> <span class="token number">1000</span> km WITHCOORD WITHDIST count <span class="token number">2</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"xian"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"483.8340"</span>
   <span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"108.96000176668167114"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"34.25999964418929977"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"nanjing"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"864.9816"</span>
   <span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"118.75999957323074341"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"32.03999960287850968"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="GEORADIUSBYMEMBER：-显示与指定成员一定半径范围内的其他成员（6-2-0之后弃用）">GEORADIUSBYMEMBER： 显示与指定成员一定半径范围内的其他成员（6.2.0之后弃用）</h2>
<blockquote>
<p>从Redis版本6.2.0开始，此命令被认为已弃用。 可将其替换为<code>GEOSEARCH</code>和<code>GEOSEARCHSTORE</code>，并使用<code>BYRADIUS</code>和<code>FROMMEMBER</code>参数</p>
</blockquote>
<p><strong>GEORADIUSBYMEMBER</strong> key member radius <strong>&lt;M | KM | FT | MI&gt;</strong> [<strong>WITHCOORD</strong>]<br>
[<strong>WITHDIST</strong>] [<strong>WITHHASH</strong>] [<strong>COUNT</strong> count [<strong>ANY</strong>]] [<strong>ASC</strong> | <strong>DESC</strong>] [<strong>STORE</strong> key]<br>
[<strong>STOREDIST</strong> key]</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> GEORADIUSBYMEMBER china:city taiyuan <span class="token number">1000</span> km
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"nanjing"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"taiyuan"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"xian"</span>
<span class="token operator">&gt;</span> GEORADIUSBYMEMBER china:city taiyuan <span class="token number">1000</span> km withcoord WITHDIST count <span class="token number">2</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"taiyuan"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"0.0000"</span>
   <span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"112.54999905824661255"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"37.86000073876942196"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"xian"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"514.2264"</span>
   <span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"108.96000176668167114"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"34.25999964418929977"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1>Redis Stream</h1>
<p>Redis Stream 是一种数据结构，其作用类似于<code>an append-only log</code>。您可以使用流实时记录和同步事件。</p>
<p>Redis Stream 用例的示例包括：</p>
<ul>
<li>事件溯源（例如，跟踪用户操作、点击等）</li>
<li>传感器监控（例如，现场设备的读数）</li>
<li>通知（例如，将每个用户的通知记录存储在单独的流中）</li>
</ul>
<p>Redis 为每个流条目生成一个唯一的 ID。您可以使用这些 ID 稍后检索其关联条目或读取和处理流中的所有后续条</p>
<table>
<thead>
<tr>
<th style="text-align:left">命令</th>
<th>使用</th>
<th>功能</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><a href="#STREAM_XADD">XADD</a></td>
<td></td>
<td>增</td>
<td style="text-align:left">唯一可以将数据添加到流的 Redis 命令</td>
</tr>
<tr>
<td style="text-align:left"><a href="#STREAM_XRANGE">XRANGE</a>/ <a href="#STREAM_XREVRANGE">XREVRANGE</a></td>
<td></td>
<td>查</td>
<td style="text-align:left">返回流中的一段元素</td>
</tr>
<tr>
<td style="text-align:left"><a href="#STREAM_XREAD">XREAD</a></td>
<td></td>
<td>查</td>
<td style="text-align:left">从一个或多个流中读取数据，只返回 ID 大于调用者报告的最后接收到的 ID 的条目</td>
</tr>
<tr>
<td style="text-align:left"><a href="#STREAM_XTRIM">XTRIM</a></td>
<td><strong>XTRIM</strong> <em>key</em> &lt;MAXLEN |MINID&gt; [= |~] threshold [LIMIT count]</td>
<td>删</td>
<td style="text-align:left">将流修剪到 (如果传入’~'，则大约) 某个大小</td>
</tr>
<tr>
<td style="text-align:left">XDEL</td>
<td>XDEL <em>key</em> id [id …]</td>
<td></td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left"><a href="#STREAM_XINFO">XINFO</a></td>
<td>1. <strong>XINFO STREAM</strong> key [FULL [COUNT count]]<br>2. <strong>XINFO GROUPS</strong> key<br>3. <strong>XINFO CONSUMERS</strong> key groupname <br></td>
<td>查</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">XLEN</td>
<td>XLEN key</td>
<td>查</td>
<td style="text-align:left">返回流中的条目数</td>
</tr>
<tr>
<td style="text-align:left">XSETID</td>
<td><strong>XSETID</strong> key last-id  [<strong>ENTRIESADDED</strong> entries_added]  [<strong>MAXDELETEDID</strong> max_deleted_entry_id]</td>
<td>改</td>
<td style="text-align:left">XSETID 命令是一个内部命令。 Redis 主服务器使用它来复制最后交付的流 ID。</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td></td>
<td></td>
<td style="text-align:left"></td>
</tr>
</tbody>
</table>
<p>消息分组</p>
<table>
<thead>
<tr>
<th style="text-align:left">命令</th>
<th>使用</th>
<th>功能</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><a href="#STREAM_XGROUP_CREATE">XGROUP CREATE</a></td>
<td><strong>XGROUP CREATE</strong> key groupname <font color="blue"> &lt;<strong>id |$</strong> &gt; </font> <font color="green">[<strong>MKSTREAM</strong>]</font> <strong>[ENTRIESREAD entries_read]</strong></td>
<td>增</td>
<td style="text-align:left">创建消费者组</td>
</tr>
<tr>
<td style="text-align:left"><a href="#STREAM_XGROUP_CREATECONSUMER">XGROUP CREATECONSUMER</a></td>
<td><strong>XGROUP CREATECONSUMER</strong> key groupname consumername</td>
<td>增</td>
<td style="text-align:left">在消费者组中创建消费者</td>
</tr>
<tr>
<td style="text-align:left"><a href="#STREAM_XGROUP_DELCONSUMER">XGROUP DELCONSUMER</a></td>
<td><strong>XGROUP DELCONSUMER</strong> key groupname consumername</td>
<td>删</td>
<td style="text-align:left">删除消费者</td>
</tr>
<tr>
<td style="text-align:left"><a href="#STREAM_XGROUP_DESTROY">XGROUP DESTROY</a></td>
<td><strong>XGROUP DESTROY</strong> key groupname</td>
<td>删</td>
<td style="text-align:left">消费者组</td>
</tr>
<tr>
<td style="text-align:left"><a href="#STREAM_XGROUP_SETID">XGROUP SETID</a></td>
<td><strong>XGROUP SETID</strong> key groupname <font color="blue"> &lt;<strong>id |$</strong> &gt; </font> [ENTRIESREAD entries_read]</td>
<td>改</td>
<td style="text-align:left">修改消费者组的最后一个交付ID</td>
</tr>
<tr>
<td style="text-align:left"><a href="#STREAM_XREADGROUP">XREADGROUP</a></td>
<td><strong>XREADGROUP</strong> <strong>GROUP</strong> group consumer [<strong>COUNT</strong> count] <font color="blue"> [<strong>BLOCK</strong> milliseconds]</font>  [<strong>NOACK</strong>] <strong>STREAMS</strong> key [key …] <font color="orange">id [id …]</font></td>
<td>查/改</td>
<td style="text-align:left">从消费者组返回新条目，或者访问给定消费者的待处理条目的历史记录</td>
</tr>
<tr>
<td style="text-align:left"><a href="#STREAM_XPENDING">XPENDING</a></td>
<td><strong>XPENDING</strong> key group [<font color="blue">[IDLE min-idle-time] start end count [consumer]</font>]</td>
<td>查</td>
<td style="text-align:left">从消费者组<code>PEL</code>中 返回获取了但从未确认的消息信息和条目</td>
</tr>
<tr>
<td style="text-align:left"><a href="#STREAM_XCLAIM">XCLAIM</a></td>
<td><strong>XCLAIM</strong>  key group consumer  min-idle-time id [id …] [<strong>IDLE</strong> ms]   [<strong>TIME</strong> unix-time-milliseconds] [<strong>RETRYCOUNT</strong> count] [<strong>FORCE</strong>] [<strong>JUSTID</strong>]   [<strong>LASTID</strong> id]</td>
<td></td>
<td style="text-align:left">更改(或获得)使用者组中消息的所有权，就像消息已交付给指定的使用者一样。</td>
</tr>
<tr>
<td style="text-align:left"><a href="#STREAM_XAUTOCLAIM">XAUTOCLAIM</a></td>
<td></td>
<td></td>
<td style="text-align:left">更改(或获取)使用者组中消息的所有权，就像将消息交付给指定的使用者一样。</td>
</tr>
<tr>
<td style="text-align:left"><a href="#STREAM_XACK">XACK</a></td>
<td><strong>XACK</strong> key group id [id …]</td>
<td></td>
<td style="text-align:left">将挂起的消息标记为正确处理，有效地将其从使用者组的挂起条目列表中删除。该命令的返回值是成功确认的消息的数量，也就是说，我们实际上能够在PEL中解析的id。</td>
</tr>
</tbody>
</table>
<h2 id="span-id-STREAM-XADD-XADD-span"><span id="STREAM_XADD">XADD</span></h2>
<ul>
<li>
<p>命令详情</p>
<p>XADD key <font color="green"> [<strong>NOMKSTREAM</strong>]</font> <font color="blue"> [&lt;<strong>MAXLEN</strong> | <strong>MINID</strong>&gt; [= | ~] threshold [<strong>LIMIT</strong> <em>count</em>]] </font>  <font color="orange">&lt;* | id&gt;</font>  <em>field value [field value …]</em></p>
</li>
<li>
<p>命令参数解释</p>
<ol>
<li>
<p>可以使用 <code>NOMKSTREAM </code>选项禁用 <em>Stream key</em> 的创建（key不存在时，返回null）</p>
</li>
<li>
<p><font color="orange">&lt;* | id&gt;</font>  id组成方式：<code>&lt;millisecondsTime&gt;-&lt;sequenceNumber&gt;</code></p>
<ul>
<li>
<p>如果指定的 ID 参数是 <code>*</code>字符，XADD 命令将为您自动生成唯一 ID</p>
<p><code>XADD stream:test:1 * ip 127.0.0.1</code></p>
</li>
<li>
<p>虽然仅在极少数情况下有用，但可以指定格式良好的 ID，以便将使用指定的 ID 精确添加新条目。</p>
<p><code>XADD stream:test:1 1662020231547-1 ip 127.0.0.2</code></p>
<p>当用户为 指定显式 ID 时<code>XADD</code>，最小有效 ID 为 <code>0-1</code>，并且用户<em>必须</em>指定一个大于当前流内任何其他 ID 的 ID，否则该命令将失败并返回错误。</p>
<p>通常，仅当您有另一个系统生成唯一 ID（例如 SQL 表）并且您确实希望 Redis 流 ID 与另一个系统匹配时，才使用特定 ID。</p>
</li>
</ul>
</li>
<li>
<p><font color="blue">[&lt;<strong>MAXLEN</strong> | <strong>MINID</strong>&gt; [= | ~] threshold<br>
[<strong>LIMIT</strong> count]]</font>    封顶（Capped streams）</p>
<p><code>MAXLEN</code>：使用 MAXLEN，当达到指定长度时，旧条目会被自动驱逐</p>
<p><code>~</code>：表示封顶的阈值 count是一个近似值。<code>MAXLEN ~ 1000</code>我真的不需要这正好是 1000 个项目。它可以是 1000 或 1010 或 1030，只要确保至少保存 1000 个项目即可（常用场景）</p>
<p><code>MINID</code>：驱逐 ID 低于阈值的条目，其中阈值是流 ID</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> XADD mystream <span class="token number">1526919030474</span>-55 message <span class="token string">"Hello,"</span> 
<span class="token operator">&gt;</span> XADD mystream <span class="token number">1526919030474</span>-* message <span class="token string">" World!"</span>
<span class="token operator">&gt;</span> XADD mystream MAXLEN ~ <span class="token number">1000</span> * <span class="token punctuation">..</span>. entry fields here <span class="token punctuation">..</span>.
<span class="token operator">&gt;</span> XADD stest MINID <span class="token operator">=</span> <span class="token number">1670928883730</span>-0 * name zs age <span class="token number">12</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ol>
</li>
<li>
<p>版本变更</p>
<p>版本6.2.0 前：<strong>XADD</strong> key <strong>ID</strong> <em>field string [field string …]</em></p>
<p>版本6.2.0后 ：添加了 **NOMKSTREAM 、MINID、  LIMIT **</p>
<p>版本7.0.0 ： 添加了对 显式 ID 形式的支持</p>
</li>
</ul>
<h2 id="span-id-STREAM-XRANGE-XRANGE-span"><span id="STREAM_XRANGE">XRANGE</span></h2>
<ul>
<li>
<p>详细命令</p>
<p><strong>XRANGE</strong> key <font color="blue">startId endId</font> <font color="orange">[COUNT count]</font></p>
</li>
<li>
<p>命令参数解释</p>
<ol>
<li>
<p><font style="color:blue;font-weight:bold">startId endId</font>:  startId 和 endId 之间为闭区间</p>
<ul>
<li>
<p>-和 + 特殊 ID 分别表示流中可能的最小 ID 和可能的最大 ID，因此以下命令将仅返回流中的所有条目：<code>XRANGE somestream - +</code></p>
<p><code>-</code>: 可以理解为：0-0</p>
<p><code>+</code>: 可以理解为：18446744073709551615-18446744073709551615</p>
</li>
<li>
<p>Incomplete IDs</p>
<p>不完整指定的ID：仅仅指定 UNIX 时间部分：<code>XRANGE somestream 1526985054069 1526985055069</code></p>
<p>在这种情况下，XRANGE 将使用 -0 自动完成开始间隔，使用 -18446744073709551615 自动完成结束间隔，以便返回在给定毫秒和另一个指定毫秒结束之间生成的所有条目。</p>
<p>这也意味着<strong>重复相同的毫秒两次，我们得到指定毫秒内的所有条目</strong></p>
<p>以这种方式使用 XRANGE 作为范围查询命令来获取指定时间内的条目。这对于获取一段时间内的操作历史，非常方便。</p>
</li>
<li>
<p>Exclusive ranges</p>
<p>开区间范围查询：ID 前加上字符<code>(</code>来指定一个开区间：<code>XRANGE somestream (1526985685298-0 + COUNT 2</code></p>
</li>
</ul>
</li>
<li>
<p><font color="orange">[<strong>COUNT</strong> count]</font> : 返回结果的前count条entry</p>
</li>
</ol>
</li>
<li>
<p>使用场景介绍</p>
<ol>
<li>
<p>stream 迭代</p>
<p>a. 上次查询的entry的id 用 开区间 <code>(</code>，作为下次查询的start 。</p>
<p>b. 我们可以从任何 ID 开始迭代（指定一个不完整的start id）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> XRANGE writers - + COUNT <span class="token number">2</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1526985676425</span>-0
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"name"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"Virginia"</span>
      <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"surname"</span>
      <span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"Woolf"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1526985685298</span>-0
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"name"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"Jane"</span>
      <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"surname"</span>
      <span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"Austen"</span>
<span class="token operator">&gt;</span> XRANGE writers <span class="token punctuation">(</span><span class="token number">1526985685298</span>-0 + COUNT <span class="token number">2</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1526985691746</span>-0
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"name"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"Toni"</span>
      <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"surname"</span>
      <span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"Morrison"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1526985712947</span>-0
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"name"</span>
    <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"Agatha"</span>
      <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"surname"</span>
    <span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"Christie"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p>获取单个项目</p>
<p>XRANGE 的参数中指定两次 ID：<code>XRANGE mystream 1526984818136-0 1526984818136-0</code></p>
</li>
</ol>
</li>
</ul>
<h2 id="span-id-STREAM-XREVRANGE-XREVRANGE-span"><span id="STREAM_XREVRANGE">XREVRANGE</span></h2>
<ul>
<li>
<p>详细命令</p>
<p>XREVRANGE key end start [COUNT count]</p>
</li>
<li>
<p>举例</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">XREVRANGE somestream + - COUNT <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ul>
<h2 id="span-id-STREAM-XREAD-XREAD-span"><span id="STREAM_XREAD">XREAD</span></h2>
<ul>
<li>
<p>命令详情</p>
<p><strong>XREAD</strong> [<strong>COUNT</strong> count] <font color="green">[<strong>BLOCK</strong> milliseconds]</font> <font color="blue"><strong>STREAMS</strong> key [key …] id<br>
[id …]</font></p>
</li>
<li>
<p>命令参数解释</p>
<p><strong>STREAMS</strong> key [key …] id [id …]：指定了一个键列表以及调用消费者已经为每个流看到的相应最大 ID，因此该命令将只向客户端提供 ID  <code>大于</code>我们指定的 ID 的消息。（不包含指定的ID）</p>
<p>[<strong>BLOCK</strong> milliseconds]：阻塞的毫秒数。若milliseconds 设置为0 ，则表示永远不会超时</p>
<p>[<strong>COUNT</strong> count]：限定调用将在每个流中最多返回count个元素</p>
</li>
<li>
<p>特殊的ID<code>$</code></p>
<p><strong>STREAMS</strong> $ :  意味着应该使用已经存储在流中的最大 ID 作为最后一个 ID。</p>
<p>当阻塞时，有时我们希望只接收从阻塞那一刻开始通过XADD添加到流中的条目。在这种情况下，我们对已经添加的条目的历史不感兴趣。</p>
<p>对于这个用例，我们必须检查流顶部元素的ID，并在XREAD命令行中使用这样的ID。这是不干净的，需要调用其他命令，所以可以使用特殊的 <code>$</code> 来通知流，我们只想要新的东西。</p>
<p><strong>仅在第一次调用 XREAD 时使用 $ ID 非常重要。之后迭代的ID应该是流中最后报告的ID，否则您可能会错过中间添加的所有条目。</strong></p>
<table>
<thead>
<tr>
<th>客户端A</th>
<th>客户端B</th>
<th>客户端C</th>
</tr>
</thead>
<tbody>
<tr>
<td>&gt; XREAD COUNT 1 block 30000 STREAMS test $</td>
<td>&gt; XREAD COUNT 1 block 30000 STREAMS test $</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>&gt; xadd test * name wangwu age 22<br>1675666852907-0</td>
</tr>
<tr>
<td>test<br>1675666852907-0<br>name<br>wangwu<br>age<br>22</td>
<td>test<br>1675666852907-0<br>name<br>wangwu<br>age<br>22</td>
<td></td>
</tr>
</tbody>
</table>
<blockquote>
<p>客户端C 发送消息时，阻塞等待的客户端A、客户端B 均接受到了流中新增条目</p>
</blockquote>
</li>
<li>
<p>使用场景</p>
<ol>
<li>
<p>非阻塞情况：从多个流读取数据（XRANGE 的扩展版本）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> XREAD COUNT <span class="token number">2</span> STREAMS mystream writers <span class="token number">0</span>-0 <span class="token number">0</span>-0
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"mystream"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1526984818136</span>-0
         <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"duration"</span>
            <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"1532"</span>
            <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"event-id"</span>
            <span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"5"</span>
            <span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"user-id"</span>
            <span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">"7782813"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1526999352406</span>-0
         <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"duration"</span>
            <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"812"</span>
            <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"event-id"</span>
            <span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"9"</span>
            <span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"user-id"</span>
            <span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">"388234"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"writers"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1526985676425</span>-0
         <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"name"</span>
            <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"Virginia"</span>
            <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"surname"</span>
            <span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"Woolf"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1526985685298</span>-0
         <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"name"</span>
            <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"Jane"</span>
            <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"surname"</span>
            <span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"Austen"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p>阻塞情况下：（无返回数据的情况下，等待数据返回）</p>
<p>消费者第一次迭代：从我们开始收听的时间开始，阻塞等待最新消息</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> XREAD BLOCK <span class="token number">5000</span> COUNT <span class="token number">100</span> STREAMS mystream $<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>一旦我们得到一些回复，下一次调用将是这样的：阻塞等待<code>1526999644174-3</code>之后的数据</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> XREAD BLOCK <span class="token number">5000</span> COUNT <span class="token number">100</span> STREAMS mystream <span class="token number">1526999644174</span>-3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
</li>
<li>
<p>如何为单个流上被阻止的多个客户端提供服务：<strong>FIFO</strong></p>
<ol>
<li>
<p>当新项目可用时，为给定流阻塞的第一个客户端将是第一个被解除阻塞的客户端。因为从等待数据的客户端的角度来看，阻塞流读取是公平的，其语义是 FIFO 风格。（类似于阻塞队列）</p>
</li>
<li>
<p>为客户端提供服务时，不会从流中删除流条目，因此只要 XADD 命令向流提供数据，就会为每个等待的客户端提供服务。（不同于阻塞队列）</p>
</li>
</ol>
</li>
</ul>
<h2 id="span-id-STREAM-XTRIM-XTRIM-span"><span id="STREAM_XTRIM"> XTRIM</span></h2>
<ul>
<li>
<p>命令详情</p>
<p><strong>XTRIM</strong> <em>key</em> &lt;MAXLEN | MINID&gt; [= | ~] threshold [LIMIT count]</p>
</li>
<li>
<p>命令参数解释</p>
<p>MAXLEN:  只要流的长度超过指定的阈值，就逐出条目，其中阈值是一个正整数。</p>
<p>MINID: 驱逐 ID 低于阈值的条目，其中阈值是流 ID。</p>
</li>
<li>
<p>返回：成功移除数据量</p>
</li>
<li>
<p>示范</p>
<ol>
<li>
<p>精确修剪<code>=</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">XTRIM mystream MAXLEN <span class="token number">1000</span>
XTRIM mystream MINID <span class="token number">649085820</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li>
<p>近乎精确的修剪</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">XTRIM mystream MAXLEN ~ <span class="token number">1000</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
</li>
</ul>
<h2 id="span-id-STREAM-XINFO-XINFO-span"><span id="STREAM_XINFO"> XINFO</span></h2>
<h3 id="XINFO-STREAM">XINFO STREAM</h3>
<ul>
<li>
<p>命令详情</p>
<p><strong>XINFO STREAM</strong> key [FULL [COUNT count]]：</p>
</li>
<li>
<p>此命令返回有关存储在 <key> 中的流的信息。详细信息是：</key></p>
<ul>
<li><strong>length</strong>: 流中的条目数</li>
<li><strong>radix-tree-keys</strong>: 底层基数数据结构中的键数</li>
<li><strong>radix-tree-nodes</strong>: 底层基数数据结构中的节点数</li>
<li><strong>groups</strong>: 底层基数数据结构中的节点数 groups：为流定义的消费者组数</li>
<li><strong>last-generated-id</strong>:添加到流中的最近条目的 ID</li>
<li><strong>max-deleted-entry-id</strong>: 从流中删除的最大条目 ID</li>
<li><strong>entries-added</strong>: 在其生命周期内添加到流中的所有条目的计数</li>
<li><strong>first-entry</strong>: 流中第一个条目的 ID 和字段值元组</li>
<li><strong>last-entry</strong>: 流中最后一个条目的 ID 和字段值元组</li>
</ul>
</li>
</ul>
<h3 id="XINFO-GROUPS">XINFO GROUPS</h3>
<ul>
<li>
<p>命令详情</p>
<p>XINFO GROUPS key</p>
</li>
</ul>
<h3 id="XINFO-CONSUMERS">XINFO CONSUMERS</h3>
<ul>
<li>
<p>命令详情</p>
<p>XINFO CONSUMERS key groupname</p>
</li>
</ul>
<h2 id="span-id-STREAM-GROUP-XGROUP-span"><span id="STREAM_GROUP"> XGROUP</span></h2>
<ul>
<li>
<p><strong>XGROUP</strong> 用于创建、销毁和管理消费者组。</p>
</li>
<li>
<p><strong>XREADGROUP</strong> 用于通过消费者组从流中读取。</p>
</li>
<li>
<p><strong>XACK</strong> 是允许消费者将未决消息标记为已正确处理的命令。</p>
</li>
</ul>
<h3 id="span-id-STREAM-XGROUP-CREATE-XGROUP-CREATE-span"><span id="STREAM_XGROUP_CREATE"> XGROUP CREATE</span></h3>
<ul>
<li>
<p>命令详情</p>
<p><strong>XGROUP CREATE</strong> key groupname  <font color="blue"> &lt;<strong>id | $</strong> &gt; </font>  <font color="green">[<strong>MKSTREAM</strong>]</font>  <strong>[ENTRIESREAD entries_read]</strong></p>
</li>
<li>
<p>参数说明</p>
<ol>
<li>
<p><font color="blue"> &lt;<strong>id | $</strong> &gt; </font> ：从新组的角度指定流中最后传送的条目。</p>
<p>例如，如果您希望组的消费者从头开始获取整个流，使用零作为消费者组的起始 ID。特殊 ID <code>$</code> 是指流中最后一个条目的 ID</p>
</li>
<li>
<p><font color="green">[<strong>MKSTREAM</strong>]</font>: 流不存在时，自动创建，否则返回 key不存在的异常</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ERR The XGROUP subcommand requires the key to exist. Note that <span class="token keyword">for</span> CREATE you may want to use the MKSTREAM option to create an empty stream automatically.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>[ENTRIESREAD entries_read]</strong></p>
<p>从 指定的 <font color="blue"> &lt;<strong>id | $</strong> &gt;</font>，到最后一个条目，指定读取的条目容量</p>
</li>
</ol>
</li>
<li>
<p>功能说明</p>
<p>创建消费者组</p>
</li>
</ul>
<h3 id="span-id-STREAM-XGROUP-CREATECONSUMER-XGROUP-CREATECONSUMER-span"><span id="STREAM_XGROUP_CREATECONSUMER">XGROUP CREATECONSUMER</span></h3>
<ul>
<li>
<p>命令详情</p>
<p><strong>XGROUP CREATECONSUMER</strong> key groupname consumername</p>
</li>
<li>
<p>功能说明</p>
<p>在消费者组中创建消费者</p>
</li>
</ul>
<h3 id="span-id-STREAM-XGROUP-DELCONSUMER-XGROUP-DELCONSUMER-span"><span id="STREAM_XGROUP_DELCONSUMER">XGROUP DELCONSUMER</span></h3>
<ul>
<li>
<p>命令详情</p>
<p><strong>XGROUP DELCONSUMER</strong> key groupname consumername</p>
</li>
<li>
<p>功能说明</p>
<p>在消费者组中删除消费者。消费者拥有的任何待处理消息在被删除后将变得不可领取。因此，强烈建议在从组中删除消费者之前声明或确认任何未决消息。</p>
</li>
</ul>
<h3 id="span-id-STREAM-XGROUP-DESTROY-XGROUP-DESTROY-span"><span id="STREAM_XGROUP_DESTROY">XGROUP DESTROY</span></h3>
<ul>
<li>
<p>命令详情</p>
<p><strong>XGROUP DESTROY</strong> key groupname</p>
</li>
<li>
<p>功能说明</p>
<p>摧毁一个消费者组。即使有活跃的消费者和待处理的消息，消费者组也会被销毁，因此请确保仅在真正需要时才调用此命令。</p>
</li>
</ul>
<h3 id="span-id-STREAM-XGROUP-SETID-XGROUP-SETID-span"><span id="STREAM_XGROUP_SETID">XGROUP SETID</span></h3>
<ul>
<li>
<p>命令详情</p>
<p><strong>XGROUP SETID</strong> key groupname  <font color="blue"> &lt;<strong>id | $</strong> &gt; </font>  [ENTRIESREAD entries_read]</p>
</li>
<li>
<p>功能说明</p>
<p><strong>XGROUP SETID</strong>命令允许修改组的最后一个交付ID，而不必删除和重新创建组。例如，如果你想让消费者组中的消费者重新处理流中的所有消息，你可以将其下一个ID设置为0</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">XGROUP SETID mystream mygroup <span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ul>
<h3 id="span-id-STREAM-XREADGROUP-XREADGROUP-span"><span id="STREAM_XREADGROUP">XREADGROUP</span></h3>
<ul>
<li>
<p>命令详情</p>
<p><strong>XREADGROUP</strong> <strong>GROUP</strong> group consumer [<strong>COUNT</strong> count] <font color="blue"> [<strong>BLOCK</strong> milliseconds]</font>  [<strong>NOACK</strong>] <strong>STREAMS</strong> key [key …] <font color="orange">id [id …]</font></p>
</li>
<li>
<p>参数说明</p>
<p><font color="orange">id [id …]</font>：</p>
<ul>
<li>若id为 <code>&gt;</code> :  使用者只想接收从未传递给任何其他使用者的消息</li>
<li>任何其他ID，即 <code>0</code> 或任何其他有效ID或不完整ID（仅为毫秒时间部分），客户端访问的是：传递给它但尚未确认的消息（历史记录的概念）。注意，在这种情况下，BLOCK和NOACK都被忽略。</li>
</ul>
</li>
<li>
<p>功能说明</p>
<p>使用 <code>XREADGROUP </code> 可以创建<strong>客户端组</strong>来消费到达给定流的消息的不同部分。例如，如果流获得新的条目 A、B 和 C，并且有两个消费者通过消费者组读取消息，一个客户端将获得消息 A 和 C，另一个客户端将获得消息 B。</p>
<p>但是要实现多个键中读取，您需要在每个流中创建一个具有相同名称的消费者组（不常见的需求）</p>
</li>
<li>
<p>举例</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> XGROUP CREATE mystream mygroup $ MKSTREAM
<span class="token operator">&gt;</span> XADD mystream * message apple
<span class="token operator">&gt;</span> XADD mystream * message orange
<span class="token operator">&gt;</span> XADD mystream * message strawberry
<span class="token operator">&gt;</span> XADD mystream * message apricot


<span class="token operator">&gt;</span> XRANGE mystream - +
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1675738497958-0"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"message"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"apple"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1675738498027-0"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"message"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"orange"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1675738498119-0"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"message"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"strawberry"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1675738498206-0"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"message"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"apricot"</span>
      
      
<span class="token operator">&gt;</span> XREADGROUP GROUP mygroup Alice STREAMS mystream <span class="token number">0</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"mystream"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>empty array<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> XADD mystream * message banana
<span class="token string">"1675738604129-0"</span>

<span class="token comment">## 接收条目</span>
<span class="token operator">&gt;</span> XREADGROUP GROUP mygroup Alice COUNT <span class="token number">1</span> STREAMS mystream <span class="token operator">&gt;</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"mystream"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1675738667048-0"</span>
         <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"message"</span>
            <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"apple"</span>
         
<span class="token comment">## 已接收但是未确认的历史消息列表</span>
<span class="token operator">&gt;</span> XREADGROUP GROUP mygroup Alice STREAMS mystream <span class="token number">0</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"mystream"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1675738667048-0"</span>
         <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"message"</span>
            <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"apple"</span>
        
<span class="token comment">## 确认消息</span>
<span class="token operator">&gt;</span> XACK mystream mygroup <span class="token number">1675738667048</span>-0
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>

<span class="token comment">## 已接收但是未确认的历史消息列表</span>
<span class="token operator">&gt;</span> XREADGROUP GROUP mygroup Alice STREAMS mystream <span class="token number">0</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"mystream"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>empty array<span class="token punctuation">)</span>
   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h3 id="span-id-STREAM-XACK-XACK-span"><span id="STREAM_XACK"> XACK</span></h3>
<ul>
<li>
<p>命令详情</p>
<p><strong>XACK</strong> key group id [id …]</p>
</li>
<li>
<p>功能说明</p>
<p><code>XACK</code>命令从流使用者组的<code>Pending Entries List (PEL)</code>中删除一条或多条消息。</p>
<p>客户端成功处理了一条消息，之后应该调用<code>XACK</code>，这样该消息就不会再次被处理，同时，关于该消息的 <code>PEL</code>条目也会被清除，从而从Redis服务器释放内存。</p>
</li>
</ul>
<h3 id="span-id-STREAM-XPENDING-XPENDING-span"><span id="STREAM_XPENDING">XPENDING</span></h3>
<ul>
<li>
<p>命令详情</p>
<p><strong>XPENDING</strong> key group [<font color="blue">[IDLE min-idle-time] start end count [consumer]</font>]</p>
</li>
<li>
<p>功能说明</p>
<p>从消费者组<code>PEL</code>中 返回获取了但从未确认的消息信息和条目</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">## 前期</span>
<span class="token operator">&gt;</span> XGROUP CREATE mystream mygroup $ MKSTREAM
<span class="token operator">&gt;</span> XADD mystream * message apple
<span class="token operator">&gt;</span> XADD mystream * message orange
<span class="token operator">&gt;</span> XADD mystream * message strawberry
<span class="token operator">&gt;</span> XADD mystream * message apricot
<span class="token operator">&gt;</span> XREADGROUP GROUP mygroup Alice COUNT <span class="token number">1</span> STREAMS mystream <span class="token operator">&gt;</span>


<span class="token comment">## 实验</span>
<span class="token operator">&gt;</span> XPENDING mystream mygroup 
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"1675739360459-0"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"1675739360459-0"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"Alice"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"1"</span>
<span class="token operator">&gt;</span> XACK mystream mygroup <span class="token number">1675739360459</span>-0
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token operator">&gt;</span> XPENDING mystream mygroup 
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>nil<span class="token punctuation">)</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>nil<span class="token punctuation">)</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>nil<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h3 id="span-id-STREAM-XCLAIM-XCLAIM-span"><span id="STREAM_XCLAIM"> XCLAIM</span></h3>
<ul>
<li>
<p>命令详情</p>
<p><strong>XCLAIM</strong>  key group consumer  min-idle-time  id [id …]  [<strong>IDLE</strong> ms]<br>
[<strong>TIME</strong> unix-time-milliseconds] [<strong>RETRYCOUNT</strong> count] [<strong>FORCE</strong>] [<strong>JUSTID</strong>]<br>
[<strong>LASTID</strong> id]</p>
</li>
<li>
<p>功能说明</p>
<p>此命令用于更改待处理消息的 所有权。通常情况是这样的</p>
<ol>
<li><code>STREAM</code> 存在关联消费者组 <code>group_a</code></li>
<li>某个<code>consumer_a </code>在<code>group_a</code>的上下文中通过 <code>XREADGROUP</code> 从流中读取消息。</li>
<li>在<code>group_a</code>的待处理条目列表 (PEL) 中创建了一个待处理的消息条目：这意味着消息已传递给<code>consumer_a </code>，但尚未通过<code> XACK</code> 确认</li>
<li>然后突然之间，<code>consumer_a </code>永远地失败了</li>
<li>其他消费者可能会使用<code>XPENDING</code>命令检查挂起的消息列表，这些消息已经过期很长时间了。为了继续处理此类消息，它们使用XCLAIM获取消息的所有权并继续。使用者还可以使用<code>XAUTOCLAIM</code>命令自动扫描和声明过期的待处理消息。</li>
</ol>
<p>XCLAIM在以下情况下不会声明消息</p>
<ol>
<li>消息在组PEL中不存在(即它从未被任何消费者读取)</li>
<li>消息存在于组PEL中，但不存在于流本身(即消息被读取但从未被确认，然后通过修剪或XDEL从流中删除)</li>
</ol>
</li>
<li>
<p>命令参数</p>
<p>该命令有多个选项，但大多数主要用于内部使用，以便将<code>XCLAIM</code>或其他命令的效果传输到AOF文件中，并将相同的效果传播到副本中。</p>
<ol>
<li>
<p><strong>IDLE <ms></ms></strong>: 设置消息的空闲时间(最后一次发送)。如果没有指定IDLE，则假设IDLE为0，也就是说，时间计数将被重置，因为消息现在有一个新的所有者试图处理它。</p>
</li>
<li>
<p><strong>TIME <ms-unix-time></ms-unix-time></strong>: 这与IDLE相同，但不是相对的毫秒数，它将空闲时间设置为特定的Unix时间(以毫秒为单位)。这对于重写生成<code>XCLAIM</code>命令的AOF文件非常有用。</p>
</li>
<li>
<p><strong>RETRYCOUNT <count></count></strong>: 设置重试次数为指定值。每当再次传递消息时，此计数器都会增加。通常XCLAIM不会改变这个计数器，它只在调用<code>XPENDING</code>命令时提供给客户端:这样客户端就可以检测到异常情况，比如在尝试大量传递后由于某种原因从未处理过的消息。</p>
</li>
<li>
<p><strong>FORCE</strong>: 在PEL中创建挂起的消息条目，即使某些指定的id还没有在分配给不同客户端的PEL中。但是消息必须在流中存在，否则不存在的消息id将被忽略。</p>
</li>
<li>
<p><strong>JUSTID</strong>:  只返回成功声明的消息的id数组，而不返回实际的消息。使用此选项意味着重试计数器不增加。</p>
</li>
</ol>
</li>
<li>
<p>使用举例：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&gt;</span> XPENDING mystream mygroup 
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>nil<span class="token punctuation">)</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>nil<span class="token punctuation">)</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>nil<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> XREADGROUP GROUP mygroup Alice COUNT <span class="token number">1</span> STREAMS mystream <span class="token operator">&gt;</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"mystream"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1675739360699-0"</span>
         <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"message"</span>
            <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"apricot"</span>
<span class="token operator">&gt;</span> XPENDING mystream mygroup 
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"1675739360699-0"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"1675739360699-0"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"Alice"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"1"</span> 

<span class="token operator">&gt;</span> XCLAIM mystream mygroup Bob <span class="token number">300</span> <span class="token number">1675739360699</span>-0
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1675739360699-0"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"message"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"apricot"</span>

 
<span class="token comment">## 使用 XCLAIM 之后 1675739360699-0 的消费者由 Alice 变更为 Bob</span>
<span class="token operator">&gt;</span> XPENDING mystream mygroup 
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"1675739360699-0"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"1675739360699-0"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"Bob"</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"1"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h3 id="span-id-STREAM-XAUTOCLAIM-XAUTOCLAIM-span"><span id="STREAM_XAUTOCLAIM">XAUTOCLAIM </span></h3>
<ul>
<li>
<p>命令详情</p>
<p><strong>XAUTOCLAIM</strong> key group consumer  min-idle-time  start [<strong>COUNT</strong> count]<br>
[<strong>JUSTID</strong>]</p>
</li>
<li>
<p>功能说明</p>
<p>从概念上讲，XAUTOCLAIM 等同于调用XPENDING，然后调用XCLAIM</p>
</li>
</ul>
<h1>基础命令：<span id="Order_SCAN">SCAN</span></h1>
<ul>
<li>
<p>命令详情</p>
<p><strong>SCAN</strong> cursor [<strong>MATCH</strong> pattern] [<strong>COUNT</strong> count] [<strong>TYPE</strong> type]</p>
</li>
<li>
<p>命令参数解释</p>
<p>cursor ：开始迭代时的光标值为 0 / 上一次调用 SCAN 返回的光标以继续迭代</p>
<p><strong>TYPE</strong> type：您可以使用 TYPE 选项要求 SCAN 仅返回与给定类型匹配的对象，从而允许您遍历数据库以查找特定类型的键。TYPE 选项仅在整个数据库 SCAN 上可用，而不是 HSCAN 或 ZSCAN 等。</p>
</li>
<li>
<p>使用DEMO</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd myset <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> foo foobar feelsgood
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">6</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sscan myset <span class="token number">0</span> match f*
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"0"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"foo"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"feelsgood"</span>
   <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"foobar"</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>重要的是要注意<strong>MATCH</strong>过滤器是在从集合中检索到元素之后应用的，就在将数据返回给客户端之前。</p>
<p>这意味着如果模式匹配集合中的极少元素，<code>SCAN</code>则在大多数迭代中可能不会返回任何元素。一个例子如下所示：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> scan <span class="token number">0</span> MATCH *11*
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"288"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"key:911"</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> scan <span class="token number">288</span> MATCH *11*
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"224"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>empty list or <span class="token builtin class-name">set</span><span class="token punctuation">)</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> scan <span class="token number">224</span> MATCH *11*
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"80"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>empty list or <span class="token builtin class-name">set</span><span class="token punctuation">)</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> scan <span class="token number">80</span> MATCH *11*
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"176"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>empty list or <span class="token builtin class-name">set</span><span class="token punctuation">)</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> scan <span class="token number">176</span> MATCH *11* COUNT <span class="token number">1000</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"0"</span>
<span class="token number">2</span><span class="token punctuation">)</span>  <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"key:611"</span>
    <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"key:711"</span>
    <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"key:118"</span>
    <span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"key:117"</span>
    <span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"key:311"</span>
    <span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">"key:112"</span>
    <span class="token number">7</span><span class="token punctuation">)</span> <span class="token string">"key:111"</span>
    <span class="token number">8</span><span class="token punctuation">)</span> <span class="token string">"key:110"</span>
    <span class="token number">9</span><span class="token punctuation">)</span> <span class="token string">"key:113"</span>
   <span class="token number">10</span><span class="token punctuation">)</span> <span class="token string">"key:211"</span>
   <span class="token number">11</span><span class="token punctuation">)</span> <span class="token string">"key:411"</span>
   <span class="token number">12</span><span class="token punctuation">)</span> <span class="token string">"key:115"</span>
   <span class="token number">13</span><span class="token punctuation">)</span> <span class="token string">"key:116"</span>
   <span class="token number">14</span><span class="token punctuation">)</span> <span class="token string">"key:114"</span>
   <span class="token number">15</span><span class="token punctuation">)</span> <span class="token string">"key:119"</span>
   <span class="token number">16</span><span class="token punctuation">)</span> <span class="token string">"key:811"</span>
   <span class="token number">17</span><span class="token punctuation">)</span> <span class="token string">"key:511"</span>
   <span class="token number">18</span><span class="token punctuation">)</span> <span class="token string">"key:11"</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>如您所见，大多数调用返回零元素，但最后一次调用使用 COUNT 为 1000 以强制命令对该迭代进行更多扫描</p>
</li>
</ul>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Alisa</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://hmxyl.github.io/20230103/72ab10c8.html">https://hmxyl.github.io/20230103/72ab10c8.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Alisa</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Redis/">
                                    <span class="chip bg-color">Redis</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/20230208/6b8605c4.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/18.jpg" class="responsive-img" alt="Redis-配置文件">
                        
                        <span class="card-title">Redis-配置文件</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Redis-配置文件说明
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-02-08
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" class="post-category">
                                    数据库
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Redis/">
                        <span class="chip bg-color">Redis</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/20221103/709af9d4.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/18.jpg" class="responsive-img" alt="Redis-命令记录">
                        
                        <span class="card-title">Redis-命令记录</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Redis-命令,日常记录
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-11-03
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" class="post-category">
                                    数据库
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Redis/">
                        <span class="chip bg-color">Redis</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('5'),
            headingSelector: 'h1, h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2023</span>
            
            <span id="year">2023</span>
            <a href="/about" target="_blank">Alisa</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
            
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link ">


    <a href="mailto:hmxyldh@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

    
    

    

    

	
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
